(function(){var a=this;if(typeof SNTouch==="undefined"){a.SNTouch={}}SNTouch.VERSION="0.1.1";SNTouch.AUTHOR="PPanda";SNTouch.Model={};SNTouch.Controller={};SNTouch.View={};SNTouch={init:function(){return this.TouchReady()},TouchReady:function(){this.hideBar();this.backTop();this.placeHolder("#keywordsBottom");this.inputTouch()},hideBar:function(){setTimeout(scrollTo,0,0,1)},checkDetect:function(){var h={webkit:/(AppleWebKit)[ \/]([\w.]+)/,ipad:/(ipad).+\sos\s([\d+\_]+)/i,windows:/(windows\d*)\snt\s([\d+\.]+)/i,iphone:/(iphone)\sos\s([\d+\_]+)/i,ipod:/(ipod).+\sos\s([\d+\_]+)/i,android:/(android)\s([\d+\.]+)/i};var e=window.navigator.userAgent,c=h.webkit.exec(e),f=/\((iPhone|iPad|iPod)/i.test(e),d=[],g={},b=[];for(i in h){b=h[i].exec(e);if(b){d=h[i].exec(e)}}g={system:d[1].toLowerCase(),version:d[2].replace(/(\_|\.)/ig,".").toLowerCase(),browser:c?c[1].toLowerCase():"apple/webkit",ios:f};return g},jumpTo:function(b){setTimeout(scrollTo,100,0,document.querySelector(b).offsetTop)},backTop:function(){if(!document.querySelector("#backTop")){return}document.querySelector("#backTop").addEventListener("click",function(){setTimeout(scrollTo,100,0,1);return false},false)},placeHolder:function(d,c){if(!document.querySelector(d)){return}var d=c?document.querySelectorAll(d):document.querySelector(d);var b=d.defaultValue;d.addEventListener("focus",function(){if(d.value==b){d.value=""}},false);d.addEventListener("blur",function(){if(d.value==""){d.value=b}},false)},D:function(){if(arguments.length==0){return}return typeof arguments[0]=="string"?document.querySelector(arguments[0]):arguments[0]},DA:function(){if(arguments.length==0){return}return typeof arguments[0]=="string"?document.querySelectorAll(arguments[0]):arguments[0]},proxyEvent:function(){if(!arguments[0]){return}var b={eq:0,elemA:"",elemB:"",typeA:"click",typeB:"click",Fntype:"Fn"};$.extend(b,arguments[0]);var c={index:b.eq,Fn:function(){$(b.elemB).eq(b.eq)[b.typeB]()},Fn_form:function(){$(b.elemB).eq(b.eq)[b.typeB]}};$(b.elemA)[b.typeA]($.proxy(c,b.Fntype))},rBlur:function(){if(this.checkDetect().system=="android"){var b=document.createElement("style");b.type="text/css";b.id="rBlur";b.innerHTML="*{-webkit-tap-highlight-color:rgba(0,0,0,0)}";document.body.appendChild(b)}},inputTouch:function(){$(".label-bind").find("label").each(function(){var b=$(this);SNTouch.proxyEvent({elemA:b,elemB:b.find("input"),Fntype:"Fn_form",eq:0})})},selectBind:function(){$(".select-choose").each(function(){var b=$(this);$(this).change(function(){b.prev().html(b.find("option:selected").html())})})}};SNTouch.Validator=function(){this.emailPattern=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;this.mobilePattern=/^1[3458]\d{9}$/;this.passwordPattern=/^[a-zA-Z]*$|^[^a-zA-Z]*$|^\d*$/};SNTouch.Validator.prototype={email:function(){return this.emailPattern.test(arguments[0])},mobile:function(){return this.mobilePattern.test(arguments[0])},password:function(){return checkPwd("p_egoAcctEmailPwd_info",arguments[0])},passwordVerify:function(){return checkConfirmPwd("p_egoAcctEmailConfirmPwd_info",$("#emailLogonPassword").val(),$("#emailLogonPasswordVerify").val())}};SNTouch.HTMLTemplate=function(b,f){var f=f||{};var d=[b].join("");if(f){for(var c in f){var e=new RegExp("\\$\\{"+c+"\\}","g");d=d.replace(e,f[c])}return d}return d};SNTouch.Widget={SNCarousel:function(c){var b=this;var d={hook:"#J_index_slide",direction:"X",slideBox:".index-slide-box",slideUl:".slide_ul",slideLi:".slide_ul li",prev:".prev",next:".next",disable:"disabled",counter:".trigger",effect:"scroll",current:1,timer:350,autoplay:1,cycle:1,touch:true,asyncLoad:true};if(c){$.extend(d,c)}if(!b.D(d.hook)){return}function e(s){var Q=s;var A=$(Q.hook);var n=Q.hook;var j=Q.current;var t=0,M=0,D=0,z=0,L=Math.ceil(b.DA(n+" "+Q.slideLi).length),B=b.DA(n+" "+Q.slideLi),C=b.DA(n+" "+Q.slideUl),v=$(B),x=$(C),D=A.find(Q.slideBox).width(),z=A.find(Q.slideBox).height(),g=Q.direction=="X"?true:false,u=Q.autoplay,J=false,m=null;if(L==1){C[0].onmousedown=C[0].ontouchstart=null;P();return}if(Q.cycle==1){var f=$(B[L-1]).clone();var O=$(B[0]).clone();x.append(O);x.append(f);C[0].style.width=D*(L+2)+"px";f.get(0).style.left=-D*(L+2)+"px"}if(g){for(var I=0;I<L;I++){t+=v.eq(I).width()}}else{for(var I=0;I<L;I++){M+=v.eq(I).height()}}P();switch(Q.effect){case"ctrl":o();break;case"scroll":R();break;case"both":o();R()}function R(){if(g){var h=-t+D}else{var h=-M+z}if(Q.touch){C[0].onmousedown=C[0].ontouchstart=l}else{C.hover(function(){k.dispose()},function(){k.process()})}function l(r){var w,T;k.dispose();var U=[x.position().left,x.position().top];w=p(r);C[0].ontouchmove=C[0].onmousemove=S;function S(W){T=p(W);if(g){var V=(T[0]-w[0])+U[0];if(Math.abs(T[0]-w[0])-Math.abs(T[1]-w[1])>0){W.preventDefault();X();C[0].ontouchend=document.onmouseup=N}}else{var V=(T[1]-w[1])+U[1];W.preventDefault();X();C[0].ontouchend=document.onmouseup=N}function X(){if(g){C[0].style.left=V+"px"}else{C[0].style.top=V+"px"}}if(J){C[0].ontouchmove=C[0].ontouchend=C[0].onmousemove=document.onmouseup=null}}function N(W){var X,V=p(W);if(u){k.process()}if(g){X=V[0]-w[0];Y(W)}else{X=V[1]-w[1];Y(W)}function Y(){if(X<-D/6){G()}else{if(X<0&&X>-D/5){H()}else{if(X>D/5){K()}else{H()}}}}P();C[0].ontouchmove=C[0].ontouchend=C[0].onmousemove=document.onmouseup=null}}function p(r){var w=[];w[0]=r.changedTouches?r.changedTouches[0].clientX:r.clientX;w[1]=r.changedTouches?r.changedTouches[0].clientY:r.clientY;return w}}var H=function(){x.animate({left:-(D*(j-1))});if(Q.cycle==1){}else{}};var K=function(){if(u){k.process()}if(Q.cycle==1){if(j!=1){y();return false}else{y();B[L-1].style.left=-(D*L)+"px";B[0].style.left=0;return false}}else{if(j!=1){y();return false}else{H()}}};function y(){if(J){return}if(g){A.find(Q.slideUl).animate({left:-(D*(j-2))},Q.timer,function(){P();C[0].style.left=-(D*(j-1))+"px";B[L-1].style.left=0;J=false})}else{x.animate({top:-(z*(j-2))},Q.timer,function(){J=false})}j==1?j=L:j--;J=true;if(!Q.touch||Q.asyncLoad){q()}}var G=function(){if(Q.autoplay==1){k.process()}if(Q.cycle==1){if(j!=L){F();return false}else{F();B[0].style.left=D*L+"px";return false}}else{if(j!=L){F();return false}else{H()}}};function F(){if(J){return}if(Q.direction=="X"){A.find(Q.slideUl).animate({left:-(D*j)},Q.timer,function(){P();C[0].style.left=-(D*(j-1));B[0].style.left=0;J=false})}else{x.animate({top:-(z*j)},Q.timer,function(){J=false})}J=true;j==L?j=1:j++;if(!Q.touch||Q.asyncLoad){q()}}var q=function(){try{v.eq(j-1).find("img").attr("src",v.eq(j-1).find("img").attr("data-src")).removeAttr("data-src")}catch(h){}};var E={timerid:null,action:function(h){try{h()}catch(l){}},process:function(h){clearTimeout(this.timerid);this.timerid=setTimeout(function(){E.action(h)},0)}};function o(){A.find(Q.prev).click(function(h){if(Q.cycle==1){E.process(K)}else{if(j!=1){E.process(K)}}});A.find(Q.next).click(function(h){if(Q.cycle==1){E.process(G)}else{if(j!=L){E.process(G)}}})}function P(){var l=A.find(Q.counter);if(l.length>0){l.find("li").eq(j-1).addClass("cur").siblings().removeClass("cur")}else{if(Q.cycle!=1){var p=A.find(Q.prev),h=A.find(Q.next);p.removeClass(Q.disable);h.removeClass(Q.disable);if(L==1){p.addClass(Q.disable);h.addClass(Q.disable);return}if(j==1){p.addClass(Q.disable)}else{if(j==L){h.addClass(Q.disable)}}}}}var k={timeoutId:null,performProcessing:function(){try{G()}catch(h){}},process:function(){clearInterval(this.timeoutId);this.timeoutId=setInterval(function(){k.performProcessing()},3000)},dispose:function(){clearInterval(this.timeoutId);return}};if(Q.autoplay==1){k.process()}}return e(d)},addAppDownLoad:function(c){var b=null;if(SNTouch.checkDetect().ios){b="http://itunes.apple.com/us/app/id424598114?ls=1&mt=8";$("body").before('<div class="appdownload w" style="position:relative;" id="appdownload"><a href="'+b+'" name="wap_home_head02001" ><img height="40" src="'+c+'" alt=""></a><a href="javascript:;" style="position:absolute;right:0;top:0;width:40px;height:40px;" onclick="this.parentNode.parentNode.removeChild(this.parentNode)"></a></div>')}if(SNTouch.checkDetect().system=="android"){b="http://mapp.suning.com/index.php?app=topicdetail&specialId=48";$("body").before('<div class="appdownload w" style="position:relative;" id="appdownload"><a href="'+b+'" name="wap_home_head02001" ><img height="40" src="'+c+'" alt=""></a><a href="javascript:;" style="position:absolute;right:0;top:0;width:40px;height:40px;" onclick="this.parentNode.parentNode.removeChild(this.parentNode)"></a></div>')}}};SNTouch.lazyload=function(c){if(!document.querySelector(c)){return}var b=null;$(c).find("img").each(function(){var d=$(this)[0];if(d.offsetTop<window.innerHeight){d.src=d.getAttribute("data-src");d.className=d.className+" bounceIn";d.setAttribute("data-src","done")}});window.addEventListener("scroll",function(){b=setTimeout(function(){$(c).find("img").each(function(){var f=$(this)[0];if(f.getAttribute("data-src")==null){return}var e=f.offsetTop;var d=window.innerHeight||window.screen.height;if(window.pageYOffset>e+d||window.pageYOffset<e-d&&f.getAttribute("data-src")!="done"){clearTimeout(b);return}if(window.pageYOffset>e-d&&f.getAttribute("data-src")!="done"){f.src=f.getAttribute("data-src");f.className=f.className+" bounceIn";f.setAttribute("data-src","done")}})},300)},false)};SNTouch.Widget.SNTabs=function(b){this.settings=b||{};this.uid=this.settings.uid||"";this.tabBtn=this.settings.tabBtn||"#tab";this.tabBtnElem=this.settings.tabBtnElem||"li";this.tabBtnClass=this.settings.tabBtnClass||"cur";this.tabType=this.settings.tabType||"click";this.tabBox=this.settings.tabBox||"";this.tabBoxClass=this.settings.tabBoxClass||".tabBox";this.tabMore=this.settings.tabMore||".tab-more";this.show=this.settings.show||"show";this.hide=this.settings.hide||"hide";this.callback=this.settings.callback||function(){};this.ajaxData=this.settings.ajaxData||[];this.ajaxType=this.settings.ajaxType||"GET";this.ajaxDataType=this.settings.ajaxDataType||"html";this.delay=this.settings.delay||false;this.delayTime=this.settings.delayTime||300;this.initializer()};SNTouch.Widget.SNTabs.prototype={loadHtml:"<div class='loading' style='padding:20px 0'></div>",timer:null,initializer:function(){this.startFn()},ajax:function(e){var d=this;var f=this.ajaxPara;var b=$(d.tabBox)||$(d.uid);var c=b.find(d.tabBoxClass).eq(e);if(d.ajaxData.length==0){return}if(d.ajaxData.length>0&&!c.hasClass("done")&&e>0){$.ajax({url:d.ajaxData[e-1].ajaxUrl,type:d.ajaxType,dataType:d.ajaxDataType,beforeSend:function(){c.html(d.loadHtml)},success:function(g){c.html(g)},error:function(){alert("网络连接失败，请检测您的网络环境稍后重试")},complete:function(){c.addClass("done");if(typeof d.ajaxData[e-1].callback=="function"){d.ajaxData[e-1].callback(c)}}})}},startFn:function(){this.bind()},bind:function(){if(this.delay){this.delayFn();return}var c=this;var d=$(c.tabBtn);var b=$(c.tabBox)||$(c.uid);d.find(c.tabBtnElem).bind(c.tabType,function(){c.tabFn(c,$(this),b)})},delayFn:function(){var c=this;var d=$(c.tabBtn);var b=$(c.tabBox)||$(c.uid);d.find(c.tabBtnElem).bind(c.tabType,function(){var e=$(this);c.timer=setTimeout(function(){c.tabFn(c,e,b)},c.delayTime)});d.find(c.tabBtnElem).mouseout(function(){clearTimeout(c.timer)})},clearDelay:function(){},unbind:function(){},tabFn:function(b,e,d){var c=e.index();e.addClass(b.tabBtnClass).siblings().removeClass(b.tabBtnClass);e.find(b.tabMore).eq(c).show().siblings().hide();d.find(b.tabBoxClass).eq(c).show().siblings(b.tabBoxClass).hide();if(b.callback||typeof b.callback=="function"){b.callback(c,b)}b.ajax(c)}};SNTouch.Widget.Popbox=function(b){this.settings=b||{};this.html=this.settings.html||"";this.contentId=this.settings.contentId||"";this.effect=this.settings.effect||"pop";this.title=this.settings.title||"提示框";this.type=this.settings.type||"fullscreen";this.callback=this.settings.callback||function(){};this.submitCallback=this.settings.submitCallback||function(){};this.cancel=this.settings.cancel||function(){};this.cls=this.settings.cls||"";this.system=this.settings.system||false;this.systemSettings=this.settings.systemSettings||{};this.loadTime=this.settings.loadTime||800;this.initializer()};SNTouch.Widget.Popbox.prototype={initializer:function(){var b=this;b.winH=document.documentElement.offsetHeight;var c=b.type=="fullscreen"?'<div id="Touch_Popbox" class="touch-popbox touch-popbox-mask000"><div id="Pop_Cotent"></div></div>':'<div id="Touch_Popbox" class="touch-inner-popbox hide"><div id="Pop_Cotent">${title}</div></div>';if(b.type=="confirm"){c='<div id="Touch_Popbox" class="touch-popbox"><div id="popinner"><div class="msg">${title}</div><div class="btn btn-sn-d"><a href="###">取消</a></div><div class="btn btn-sn-b"><a id="popsubmit" href="###">确定</a></div></div></div>'}b.html=SNTouch.HTMLTemplate(c,{title:b.title});this.systemComfirm();if(this.system){return}if($("#Touch_Popbox").length<1){$("body").append(b.html);SNTouch.rBlur()}if(b.type!="fullscreen"&&b.type!="confirm"){b.mini()}else{b.start();$("#Touch_Popbox").find(".btn-sn-d").unbind("click");$("#Touch_Popbox").find(".btn-sn-d").click(function(){b.end()});if(b.callback){b.callback()}b.submit()}},start:function(){var b=this;var c=$("#Touch_Popbox");c.css("-webkit-transform-origin","50% "+($(window).height()/2)+"px");if(SNTouch.checkDetect().ios||SNTouch.checkDetect().browser=="applewebkit"){c.show()}else{c.show()}$("#Pop_Cotent").html($(b.contentId).show());if($(b.contentId).length>0){$(b.contentId).css({position:"absolute",width:"100%",left:document.body.offsetWidth/2-$(b.contentId)[0].offsetWidth/2,top:document.body.scrollTop+$(window).height()/2-$(b.contentId).height()/2})}document.querySelector("#Touch_Popbox").style.minHeight=b.winH+"px";if($("#popinner").length>0){$("#popinner").css({left:document.body.offsetWidth/2-$("#popinner")[0].offsetWidth/2,top:document.body.scrollTop+$(window).height()/2-$("#popinner").height()/2})}},end:function(){var b=this;if(SNTouch.checkDetect().ios||SNTouch.checkDetect().browser=="applewebkit"){$("#Touch_Popbox").hide()}else{$("#Touch_Popbox").hide()}b.cancel();$("#for-android").remove()},submit:function(){var b=this;$("#popsubmit").unbind("click");$("#popsubmit").click(function(){$("#Touch_Popbox").hide();if(b.submitCallback){b.submitCallback()}})},mini:function(){var b=this;var c=$("#Touch_Popbox");if(b.cls){c.addClass(b.cls)}c.css({left:document.body.offsetWidth/2-c.width()/2,top:document.body.scrollTop+$(window).height()/2-c.height()/2});c.fadeIn(500).delay(1000).fadeOut(b.loadTime,function(){c.remove()})},systemComfirm:function(){var c=this.systemSettings;if(!this.system){return}var b={str:"",ok:function(){},cancel:function(){}};$.extend(b,c);if(confirm(b.str)){b.ok()}else{b.cancel()}},alertBox:function(){}};SNTouch.Widget.CityChoose=function(){var c={uid:"#city_select",url:"data/city.html",callback:function(){},fn:function(){}};switch(typeof arguments[0]){case"string":c.uid=arguments[0];break;case"object":$.extend(c,arguments[0]);break}$(c.uid).find("select").each(function(){$(this).css({width:$(this).parent().find(".copy-select").width()+22,height:"27px"});$(this).bind("change",function(){var e=$(this).find("option:selected").attr("data-url");if(!e||e=="none"){return}var g=$(c.uid).find(".citys");$(this).parent().find(".copy-select").html($(this).find("option:selected").html());g.find("select").remove();g.hide();if(e.indexOf(".html")==-1){var f=e.split(",")[0],d=e.split(",")[1];c.fn(f,d);return}else{g.show();c.url=e}$.get(c.url,function(l){var k=/([A-Za-z]+)([0-9]+)(.[^\|]+)()/g;var n=[];var m=null;while(m=k.exec(l)){n.push([m[2],m[3]])}var h="";for(var j=0;j<n.length;j++){h+="<option value='"+n[j][0]+"'>"+n[j][1]+"</option>"}h="<select>"+h+"</select>";g.find("select").remove();g.append(h);g.find(".copy-select").html(n[0][1]);c.fn(n[0][0],n[0][1]);b();g.find("select").change(function(){var o=$(this).find("option:selected");$(this).parent().find(".copy-select").html(o.html());c.fn(o.val(),o.html());b()})})})});var b=function(){if(typeof c.callback=="function"){c.callback()}}};SNTouch.Widget.ProCounter=function(c){var d={uid:".countArea",min:1,max:99};$.extend(d,c);var g=$(d.uid);var j=g.find(".count-input");var k=g.find(".add");var b=g.find(".min");var f=parseInt(j.val())?parseInt(j.val()):d.min,e=d.min,h=d.max;if(parseInt(j.val())>0){j.val(parseInt(j.val()))}else{j.val(e)}j.keyup(function(){f=$(this).val();if(parseInt($(this).val())>h){$(this).val(h)}if(isNaN($(this).val())||parseInt($(this).val())==0||parseInt($(this).val())<e){$(this).val(e)}});j.focus(function(){f=j.val();j.val("")});j.blur(function(){if($(this).val()==""){$(this).val(f)}});b.click(function(){f--;if(f<=e){j.val(e);f=e}else{j.val(f)}});k.click(function(){f++;if(f>h){f=h}j.val(f)})};SNTouch.Widget.Countdown=function(c){var b=new Date();this.opt=c||{};this.year=this.opt.year||b.getFullYear();this.month=this.opt.month||b.getMonth();this.day=this.opt.day||b.getDate();this.hour=this.opt.hour||b.getHours();this.minute=this.opt.minute||b.getMinutes();this.second=this.opt.second||b.getSeconds();this.Msecond=this.opt.Msecond||b.getMilliseconds();this.time=this.opt.time||b.getTime();this.yId=this.opt.yId||"#Year";this.mId=this.opt.mId||"#Month";this.dId=this.opt.dId||"#Day";this.hId=this.opt.hId||"#Hour";this.minuteId=this.opt.minuteId||"#minute";this.sId=this.opt.sId||"#Second";this.MsId=this.opt.MsId||"#Msecond";this.speed=this.opt.speed||1000;this.callback=this.opt.callback||function(){};this.idx=this.opt.idx||false};SNTouch.Widget.Countdown.prototype={timer:null,M:function(){},parse:function(){var b=this.time/this.speed;this.second=parseInt(b%60);this.minute=parseInt((b/60)%60);this.hour=parseInt((b/60/60)%24);this.day=parseInt(b/60/60/24);if(this.second<10){this.second="0"+this.second}if(this.minute<10){this.minute="0"+this.minute}},start:function(){var b=this;b.parse();this.timer=setTimeout(function(){b.run();b.changeDom()},b.speed)},run:function(){this.time-=this.speed;this.start()},changeDom:function(){if(this.time>=0){$(this.yId).html(this.year);$(this.mId).html(this.month);$(this.dId).html(this.day);$(this.hId).html(this.hour);$(this.minuteId).html(this.minute);$(this.sId).html(this.second);$(this.MsId).html(this.Msecond)}else{this.cb();clearTimeout(this.timer);timer=null}},cb:function(){if(typeof this.callback=="function"){this.callback()}}};$.extend(SNTouch.Widget,SNTouch);window.SNTouch=window.SN=SNTouch;return SNTouch})(window);